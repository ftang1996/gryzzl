{% extends "base.html" %}

{% block content %}

<div style="width: 100%; background-color: #f9f9f9;">
    <div style="width: 1350px; margin: 0 auto 30px auto; background-color: white; box-shadow: 0 4px 16px -6px black;" class="jumbotron">
      <img src='https://www.stanthonysf.org/app/uploads/2014/10/DR-Howard-and-Ellen-1080x477.jpg' style="width:75%; margin-left: 24%; margin-top: 40px; background-color: white;">

      <div style="width: 450px; height: 450px; position: relative; left: 90px; top: -330px; background-color: rgba(235,235,235, 0.8);">
          <h1 style="color: black; opacity: 100%; padding-top: 40px; text-align: center; font-size: 65px;"><strong>{{nonprofit.name}}</strong></h1>
          <h4 style="margin-top: 90px; color: black; opacity: 100%; text-align: left; margin-left: 15px;"><strong>Our Mission</strong></h4>
          <h5 style="margin-top: 40px; color: black; opacity: 100%; text-align: left; margin-left: 15px; margin-right: 10px;">{{nonprofit.description}}</h5>
      </div>

        <h2 style="text-align: center; margin-top: -250px; margin-bottom: 50px;">How your donations could help people in need:</h2>
        <div class="row justify-content-center">
        {% for item in items %}
            <div class="card" style="width: 16rem; height: 16rem;">
                <div class="card-title" style="align:center; margin-left: auto; margin-right:auto;"> <div class="centered">{{item.name}}</div></div>
                <div class="card-body">
                    <img class="card-img-top" id={{item.id}} style="width:145px;height:145px; margin-bottom: 15px; margin-top: -25px;">
                    <p class="card-text" style="padding-top: 20px;" align="center">
                        <br>
                        <i>Price:</i> ${{ item.price }}    <i>Quantity:</i>
                    <input name="qty[]"
                    onkeypress="return isNumeric(event)"
                    oninput="maxLengthCheck(this)"
                    placeholder="0"
                    type="text"
                    align="center"
                    size="3.5"
                    min = "0"
                    max = "999"
                    data-item-id = {{item.id}}
                    data-item-name = {{item.name}}
                    data-item-price = {{item.price}}
                    data-item-image = "https://cdn0.iconfinder.com/data/icons/pixel-perfect-at-24px-volume-2/24/2034-512.png"
                     />
                </div>
            </div>
        {% endfor %}
        <div class="card" style="width: 16rem; height: 16rem;">
            <div class="card-title" style="align:center; margin-left: auto; margin-right:auto;"> <div class="centered">Donate money</div></div>
            <div class="card-body">
                <img class="card-img-top" id="donate" src="http://icons.iconarchive.com/icons/cjdowner/cryptocurrency/512/Dollar-USD-icon.png" style="width:145px;height:145px; margin-bottom: 15px; margin-top: -25px;">
                <p class="card-text" align="center" style="padding-top: 20px;">
                    <br>
                    <i>Amount:</i>
                <input name="qty[]"
                onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                placeholder="0"
                type="text"
                align="center"
                size="3.5"
                min = "0"
                max = "999"
                data-item-id = "donate"
                data-item-name = "donation"
                data-item-price = 1
                data-item-image = "https://banner2.kisspng.com/20171216/5d0/dollar-sign-png-5a355146e059a3.4282492115134436549189.jpg"
                 />
            </div>
        </div>
        </div>
        <br>
        <div name="sum" class="total" align="right"></div>
        <div style=" float: right;"><button class="basketbutton"><a href="/confirm" class="donate" style="text-decoration: none;">Send your donation</a></button></div>
        <div style="margin: 40px;"></div>
    </div>
</div>


<script type="text/javascript">

  function maxLengthCheck(object) {
    if (object.value.length > object.max.length)
      object.value = object.value.slice(0, object.max.length)
      number = number + object.value; 
  }
    
  function isNumeric (evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode (key);
    var regex = /[0-9]|\./;
    if ( !regex.test(key) ) {
      theEvent.returnValue = false;
      if(theEvent.preventDefault) theEvent.preventDefault();
    }
  }
    //Get a list of input fields to sum
    document.getElementsByName("sum")[0].innerHTML = "Total Donation: $0"
    var elements = document.getElementsByName("qty[]");
    var element_array = Array.prototype.slice.call(elements);

    //Assign the keyup event handler
    for(var i=0; i < element_array.length; i++){
        element_array[i].addEventListener("keyup", sum_values);
    }

    //Function to sum the values and assign it to the last input field
    function sum_values(){
        var sum = 0;
        for(var i=0; i < element_array.length; i++){
            toAdd = parseInt(element_array[i].value, 10);
            price = element_array[i].getAttribute("data-item-price");
            if (!toAdd){
                toAdd = 0;
            }
            sum += price*toAdd;
        }
        document.getElementsByName("sum")[0].innerHTML = "Total Donation: $" + sum;
    } 
    for(var i=0; i < element_array.length-1; i++){
        id = element_array[i].getAttribute("data-item-id");
        image = element_array[i].getAttribute("data-item-image");
        document.getElementById(id).setAttribute('src', image );
    }
</script>

{% endblock %}